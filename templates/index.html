<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Insight Tracker</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; margin: 40px; background-color: #f4f4f9; }
        .container { max-width: 800px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1, h2 { color: #333; }
        form { margin-bottom: 30px; }
        input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #007bff; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .feedback-item { border-bottom: 1px solid #eee; padding: 15px 0; }
        .feedback-item:last-child { border-bottom: none; }
        .meta { font-size: 0.9em; color: #777; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Customer Insight Tracker</h1>
        <h2>Submit New Feedback</h2>
        <form id="feedback-form">
            <input type="text" id="customer-name" placeholder="Customer Name" required>
            <textarea id="feedback-text" rows="4" placeholder="Enter feedback here..." required></textarea>
            <button type="submit">Submit Feedback</button>
        </form>

        <h2>Existing Feedback</h2>
        <div id="feedback-list">
            <p>Loading feedback...</p>
        </div>
    </div>

    <script>
        const feedbackForm = document.getElementById('feedback-form');
        const feedbackList = document.getElementById('feedback-list');

        const fetchFeedback = async () => {
            const response = await fetch('/api/feedback');
            const feedback = await response.json();
            feedbackList.innerHTML = '';
            if (feedback.length === 0) {
                feedbackList.innerHTML = '<p>No feedback submitted yet.</p>';
                return;
            }
            feedback.forEach(item => {
                const div = document.createElement('div');
                div.className = 'feedback-item';
                div.innerHTML = `
                    <p><strong>${item.customer_name}</strong></p>
                    <p>${item.feedback_text}</p>
                    <p class="meta">Submitted on: ${new Date(item.timestamp).toLocaleString()}</p>
                `;
                feedbackList.appendChild(div);
            });
        };

        feedbackForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const customerName = document.getElementById('customer-name').value;
            const feedbackText = document.getElementById('feedback-text').value;

            const response = await fetch('/api/feedback', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ customer_name: customerName, feedback_text: feedbackText })
            });

            if (response.ok) {
                feedbackForm.reset();
                fetchFeedback();
            } else {
                alert('Error submitting feedback.');
            }
        });

        // Load feedback on page load
        fetchFeedback();
    </script>
</body>
</html>
